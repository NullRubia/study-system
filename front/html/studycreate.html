<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ìŠ¤í„°ë”” ê°œì„¤</title>
  </head>
  <body>
    <h2>ğŸ“ ìŠ¤í„°ë”” ê°œì„¤</h2>
    <form onsubmit="submitStudy(event)">
      <input type="text" id="title" placeholder="ì œëª©" required /><br />
      <textarea id="content" placeholder="ì„¤ëª…" required></textarea><br />
      <input
        type="number"
        id="maxMember"
        placeholder="ëª¨ì§‘ì¸ì›"
        required /><br />
      <input type="date" id="deadline" required /><br />
      <button type="submit">ë“±ë¡</button>
    </form>

    <script>
      const token = localStorage.getItem("token");
      if (!token) location.href = "login.html";

      async function submitStudy(e) {
        e.preventDefault();
        const data = {
          title: document.getElementById("title").value,
          content: document.getElementById("content").value,
          maxMember: document.getElementById("maxMember").value,
          deadline: document.getElementById("deadline").value,
        };

        const res = await fetch("http://localhost:8080/studies", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Authorization: "Bearer " + token,
          },
          body: JSON.stringify(data),
        });

        if (res.ok) {
          alert("ë“±ë¡ ì™„ë£Œ");
          location.href = "studies.html";
        } else {
          alert("ë“±ë¡ ì‹¤íŒ¨");
        }
      }
    </script>
  </body>
</html>
